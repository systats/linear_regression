<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Lineare Regression</title>
  <meta name="description" content="Dieses Book hat zum Ziel moderne Ansätze der Statistik einfach aber detailiert zu erklären. Neben den theoretischen Konzepten werden verschiedene Darstellungsformate und Modelimplication besprochen.">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Lineare Regression" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Dieses Book hat zum Ziel moderne Ansätze der Statistik einfach aber detailiert zu erklären. Neben den theoretischen Konzepten werden verschiedene Darstellungsformate und Modelimplication besprochen." />
  <meta name="github-repo" content="systats/learn_R/book/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lineare Regression" />
  
  <meta name="twitter:description" content="Dieses Book hat zum Ziel moderne Ansätze der Statistik einfach aber detailiert zu erklären. Neben den theoretischen Konzepten werden verschiedene Darstellungsformate und Modelimplication besprochen." />
  

<meta name="author" content="Simon Roth">


<meta name="date" content="2017-08-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="modelgute.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"> Statistical Learning </a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Übersicht</a></li>
<li class="chapter" data-level="1" data-path="einstieg.html"><a href="einstieg.html"><i class="fa fa-check"></i><b>1</b> Einstieg</a></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a></li>
<li class="chapter" data-level="3" data-path="modelgute.html"><a href="modelgute.html"><i class="fa fa-check"></i><b>3</b> Modelgüte</a></li>
<li class="chapter" data-level="4" data-path="residuenanalyse.html"><a href="residuenanalyse.html"><i class="fa fa-check"></i><b>4</b> Residuenanalyse</a><ul>
<li class="chapter" data-level="4.1" data-path="residuenanalyse.html"><a href="residuenanalyse.html#linearitat-der-parameter"><i class="fa fa-check"></i><b>4.1</b> Linearität der Parameter</a></li>
<li class="chapter" data-level="4.2" data-path="residuenanalyse.html"><a href="residuenanalyse.html#unabhangigkeit-der-residuen"><i class="fa fa-check"></i><b>4.2</b> Unabhängigkeit der Residuen</a></li>
<li class="chapter" data-level="4.3" data-path="residuenanalyse.html"><a href="residuenanalyse.html#homoskedastizitat"><i class="fa fa-check"></i><b>4.3</b> Homoskedastizität</a></li>
<li class="chapter" data-level="4.4" data-path="residuenanalyse.html"><a href="residuenanalyse.html#normalverteilung-der-residuen"><i class="fa fa-check"></i><b>4.4</b> Normalverteilung der Residuen</a></li>
<li class="chapter" data-level="4.5" data-path="residuenanalyse.html"><a href="residuenanalyse.html#multikolinearitat"><i class="fa fa-check"></i><b>4.5</b> Multikolinearität</a></li>
<li class="chapter" data-level="4.6" data-path="residuenanalyse.html"><a href="residuenanalyse.html#ausreier"><i class="fa fa-check"></i><b>4.6</b> Ausreißer</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://systats.github.io/" target="blank">Published by systats</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lineare Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="residuenanalyse" class="section level1">
<h1><span class="header-section-number">4</span> Residuenanalyse</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">url</span>(<span class="st">&#39;https://github.com/systats/macro_project/raw/master/project_macro.Rdata&#39;</span>))
<span class="co"># filter data</span>
dat &lt;-<span class="st"> </span>project_macro %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(year ==<span class="st"> </span><span class="dv">2010</span>)

fit0 &lt;-<span class="st"> </span><span class="kw">lm</span>(gov_cens ~<span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> dat) <span class="co"># Nullmodell</span>
fit1 &lt;-<span class="st"> </span><span class="kw">lm</span>(gov_cens ~<span class="st"> </span>engage_soc, <span class="dt">data =</span> dat) <span class="co"># bivariat</span>
fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(gov_cens ~<span class="st"> </span>engage_soc +<span class="st"> </span>pol_stability, <span class="dt">data =</span> dat) <span class="co"># multivariat</span></code></pre></div>
<p>Eine Residuenanalyse dient dazu <strong>Modellannahmen</strong> statistischer Methoden bezüglich der Verteilung der Daten zu überprüfen. Damit soll die Validität und Reliabilität der Ergebnisse sichergestellt werden. Die OLS-Schätzparameter sind unter optimalen Bedingungen effizient unter allen linearen, unverzerrten Schätzern was auch <strong>B</strong>est <strong>L</strong>inear <strong>U</strong>nbiased <strong>E</strong>stimator (BLUE, Gauß-Markov-Theorem) genannt wird. Wenn hingegen eine eindeutige Annahmenverletzung vorliegt sind die Parameter verzerrt und der Signifikanztest nicht kann mehr interpretiert werden.</p>
<p>Zur Prüfung der Modellannahmen werden neben formalen Tests verstärkt Visualisierungen genutzt. So werden Modellierungsprobleme entdeckt und verbessert. Die Chancen der Modell-Verbesserung wahrzunehmen, entspricht der Grundhaltung der explorativen Datenanalyse <a href="http://stat.ethz.ch/~stahel/courses/regression/reg-resanal.pdf">ethz statistics</a>. Es geht hier nicht um präzise mathematische Aussagen, Optimalität von statistischen Verfahren oder um Signifikanz, sondern um Methoden zum kreativen Entwickeln von Modellen, die die Daten gut beschreiben. Varianzanalyse. Was sind die Residuen gleich nochmal?</p>
<ol style="list-style-type: decimal">
<li>Linearität der Parameter</li>
<li>Unabhängigkeit der Residuen</li>
<li>Homoskedastizität</li>
<li>Normalverteilung der Residuen:</li>
</ol>
<p>Alle benötigten Informationen können mit <code>augment</code> vom broom package extrahiert werden.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw">augment</span>(fit2, dat)
<span class="co"># results %&gt;% head</span></code></pre></div>
<div id="linearitat-der-parameter" class="section level2">
<h2><span class="header-section-number">4.1</span> Linearität der Parameter</h2>
<p>Die Lineare Regression schätzt die <span class="math inline">\(\beta\)</span> Parameter intrinsisch linear. <em>The most important mathematical assumption of LM is that its deterministic components is a linear function of the seperate predictors: <span class="math inline">\(y = \beta_1 x_1 + \beta_2 x_2 + ...\)</span></em> (Gelman &amp; Hill 2007: 45). Nicht lineare Assoziationen sind ohne zusätzliche Spezifikationen nicht erfassbar. Allerdings wird jeder Parameter separat (partiell) geschätzt (Additivität), wodurch x-Variablen einfach nicht-linear transformiert und trotzdem linear interpretiert werden können.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(results, <span class="kw">aes</span>(engage_soc, gov_cens)) +<span class="st"> </span><span class="co"># aes(x, y)</span>
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) 

<span class="kw">ggplot</span>(results, <span class="kw">aes</span>(pol_stability, gov_cens)) +<span class="st"> </span><span class="co"># aes(x, y)</span>
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) </code></pre></div>
<p><img src="linear_model_files/figure-html/fit2-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Die blaue Linie zeigt den linearen Zusammenhang zwischen x und y. Durch <code>method = &quot;lm&quot;</code> kann das einfach dargestellt werden. Die Steigungen der gezeigten Regressionsgeraden entsprechen den geschätzten Parametern (0.1402374, 0.8666913, 0.3708442, 0.0964994, 0.0627666, 0.0788743, 1.453246, 13.8081601, 4.7017107, 0.1481018, 4.11735410^{-29}, 5.511039610^{-6}). Zusätzlich kann durch <code>method = &quot;loess&quot;</code> (rot) eine robuste Glättungsmethode eingesetzt werden, die auch nicht-lineare Tendenzen identifiziert und Ausreißer ignoriert. Das Streudiagramm für <code>engage_soc</code> und <code>gov_cens</code> zeigt einen eindeutig positiv, linearen Zusammenhang an. Zwar weißt die loess Funktion des rechten Streudiagramms auf eine nicht-linearen Zusammenhang hin, doch der Unterschied ist hier vernachlassigungswürdig gering. Die Regressionsgerade sollte eine gute Approximation darstellen.</p>
</div>
<div id="unabhangigkeit-der-residuen" class="section level2">
<h2><span class="header-section-number">4.2</span> Unabhängigkeit der Residuen</h2>
<p>Hängen die unbeobachteten Fehler <span class="math inline">\(\varepsioln_i\)</span> mit x zusammen? Zwar ist der bedingte Erwartungswert zwischen Prädikatoren und den Residuen ist per (OLS) Definition Null. Dennoch sollte diese Annahme getestet werden, da durch Fehlspezifikationen z.B. Autokorrelation oder <em>omitted variable bais</em> die Standardfehler falsch geschätzt werden könnten.</p>
<p><span class="math display">\[cov(x_i|\varepsilon_i) = 0\]</span></p>
<p>Um die Unabhängigkeit der Residuen zu testen, wird für jede Variable separat ein eigens Streudiagramm erstellt. Diese werden dann nach auffälligen Datenmustern (Korrelationen) untersucht. Wieder kommt neben <code>lm</code> auch <code>loess</code> zum Einsatz.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> results, <span class="kw">aes</span>(<span class="dt">x =</span> engage_soc, <span class="dt">y =</span> .resid)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) 

<span class="kw">ggplot</span>(<span class="dt">data =</span> results, <span class="kw">aes</span>(<span class="dt">x =</span> pol_stability, <span class="dt">y =</span> .resid)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F) +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) </code></pre></div>
<p><img src="linear_model_files/figure-html/other2-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Die blaue Linie symbolisiert die Regressionsgerade und darum streuen die unstandardisierten Residuen. Die Kernstreuung der Residuen (exklusive Ausreißer) scheint für beide Variablen unkorreliert zu sein. Neben einigen wenigen Ausreißern scheint keine der Variablen eine systematische Korrelation zu den Residuen zu besitzen.</p>
</div>
<div id="homoskedastizitat" class="section level2">
<h2><span class="header-section-number">4.3</span> Homoskedastizität</h2>
<p>Die Fehlervarianz <span class="math inline">\(\varepsilon_i\)</span> ist homoskedatisch, wenn die Residuen konstant, gleichverteilt um <span class="math inline">\(\hat y\)</span> streuen (<em>Homo</em> = gleich; <em>Skedastisch</em> = Streuung). Die Schätzunsicherheit sollte zufällig, gleichmäßig über das gesamte Modell/ Schätzung verteilen. Mathematisch lässt sich das so formulieren:</p>
<p><span class="math display">\[ var(x_i|\varepsilon_i)=\sigma^2_\varepsilon\]</span> Liegt keine Varianzhomogenität des Fehlers vor, spricht man von Heteroskedastizität, wodurch der Signifikanzschätzungen unbrauchbar werden. Deshalb ist eine Regression mit robusten Standardfehlern niemals verkehrt.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results %&gt;%
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(.fitted, .std.resid)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> F, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> -<span class="st"> </span><span class="kw">sd</span>(.std.resid)), <span class="dt">linetype =</span> <span class="dv">2</span>) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="kw">aes</span>(<span class="dt">yintercept =</span> <span class="kw">sd</span>(.std.resid)),  <span class="dt">linetype =</span> <span class="dv">2</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Standardized Residuals vs Fitted&quot;</span>)

<span class="kw">ggplot</span>(results, <span class="kw">aes</span>(.fitted, <span class="kw">sqrt</span>(.std.resid))) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Scale-Location&quot;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/homo2-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Auf der x-Achse wurden die geschätzten Werte (<span class="math inline">\(\hat y_i = \beta_0 + \beta_1x_i\)</span>) und auf der y-Achse die unstandardisierten Residuen abgetragen. Die zwei gestrichelten, horizontalen Linien umfassen 68,3% der Fälle und unterstützen dabei die Kernstreuung visuell zu identifizieren. Abgesehen von ein paar wenigen Ausreißern streuen die Residuen gleichverteilt um die Vorhersage.</p>
<p>Zur abschließenden Klarheit kann ein Levene-Test durchgeführt werden, dessen der Nullhypothese lautet H0: <em>die Varianzunterschiede zwischen den betrachteten Gruppen sind gleich Null</em>. Zur Durchführung des Levine-Tests muss eine Gruppenvariable erstellt werden, welche die visuell inspizierten Varianzgruppen in einem Vektor repräsentieren. Wird der Test signifikant (<span class="math inline">\(p&lt;0.05^*\)</span>) ist die Annahme verletzt und man sollte zu Methoden zur robusten Schätzung der Standardfehler (SE) greifen.</p>
</div>
<div id="normalverteilung-der-residuen" class="section level2">
<h2><span class="header-section-number">4.4</span> Normalverteilung der Residuen</h2>
<p>Die Normalverteilung der Residuen <em>is the generally the least important assumption</em> (Gelman &amp; Hill 2007: 46). Die Schätzung der <span class="math inline">\(\beta\)</span> Parameter ist davon überhaupt nicht beeinflusst. Die Signifikanz welche auf asymptotisch, normal verteilten Zufallsvariablen beruht hingegen schon. <em>We do not recommend diagnostics of the normality of regression residuals (GH: 46)</em>. Und wir tuen es doch.</p>
<p><span class="math display">\[\varepsilon_i \sim N(0, \sigma^2)\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> results, <span class="kw">aes</span>(.std.resid)) +
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density..)) +
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Standardnormalverteilung der Residuen&quot;</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> results, <span class="kw">aes</span>(<span class="dt">sample =</span> .std.resid)) +
<span class="st">  </span><span class="kw">stat_qq</span>() +
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Q-Q Plot&quot;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/nromal2-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Das kann mit einer einfachen Häufigkeitsverteilung der Residuen visuell eingeschätzt werden. Folgt die empirische Verteilung (schwarz) der theoretischen Normalverteilung (rot)? Die Residuen streuen annähernd normal verteilt um 0 mit einer konstanten Varianz. Beim Q-Q-Plot sollten die Punkte so nahe wie möglich an der roten Linie liegen. Abgesehen von ein paar Ausreißern am Ende der Verteilung sind die annähernd Residuen normal verteilt.</p>
<p>Wenn ein statistisches Modell</p>
<ol style="list-style-type: decimal">
<li>alle bisher besprochenen Annahmen erfüllt,<br />
</li>
<li>eine unverzerrte Zufallsstichprobe (Querschnitt) von einer Grundgesamtheit vor liegt sowie</li>
<li>eine angemessene Modellspezifikation vorgenommen wurde</li>
</ol>
<p>spricht man von <em>independent and identically distributed errors</em>. Anders formuliert - konsistent, erwartungstreu und normal verteilt..</p>
<p><span class="math display">\[\varepsilon_i \stackrel{iid}{\sim} N(0, \sigma^2)\]</span></p>
<p>Die Residuen sind also unkorreliert/unabhängig und homoskedatisch verteilt. Zusätzlich sollten die Residuen asymtotisch <span class="math inline">\(N\)</span> mit einem Erwartungswert von 0 und einer konstanten Varianz <span class="math inline">\(\sigma^2\)</span> um die Schätzung streuen.</p>
</div>
<div id="multikolinearitat" class="section level2">
<h2><span class="header-section-number">4.5</span> Multikolinearität</h2>
<p>(Multi-) Kollinearität liegt dann vor, wenn zwei (oder mehr) Prädikatoren stark linear voneinander abhängig sind.</p>
<p>Mit dem Toleranz-Test kann eingeschätzt werden, wie hoch der eigene Erklärungsbeitrag einer X- Variablen nach Kontrolle der übrigen Variablen ist (c.p).</p>
<p><span class="math display">\[T_k = 1−R_k^2\]</span></p>
<p>Ein Wert von kleiner 0.2 deutet auf eine starke Multikollinearität hin (lediglich ein Fünftel eigene Varianz). Werte nahe 0 implizieren, dass die jeweilige <span class="math inline">\(x_k\)</span>-Variable nur noch sehr wenig eigene Erklärungsanteile erbringt bzw. umgekehrt. Liegen viele niedrige Toleranzwerte vor, sollten Stabilitätstests durchgeführt werden. Der <strong>Variance Inflation Factor</strong> basiert auf der Toleranz ermöglicht allerdings eine bessere Interpretation.</p>
<p><span class="math display">\[VIF_k= \frac{1}{T_k} = \frac{1}{(1-R_k^2)}\]</span></p>
<p>Je größer der VI-Faktor einer Variablen k, desto stärker sind die Hinweise auf Multikollinearität. Als Daumenregel werden häufig VIF-Werte von über 10 als <em>zu hoch</em> eingestuft (andere Regel: 5 gilt als <em>harte</em> Schwelle <span class="math inline">\(\rightarrow\)</span> 1/0,2).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">car::<span class="kw">vif</span>(fit2)</code></pre></div>
<pre><code>##    engage_soc pol_stability 
##      1.144117      1.144117</code></pre>
</div>
<div id="ausreier" class="section level2">
<h2><span class="header-section-number">4.6</span> Ausreißer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results %&gt;%
<span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(.cooksd)) %&gt;%
<span class="st">  </span><span class="kw">select</span>(country, engage_soc, pol_stability, gov_cens) %&gt;%
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>##       country engage_soc pol_stability gov_cens
## 1     Belgium   1.341129     0.7815902 3.738099
## 2     Estonia   2.007244     0.5983367 3.316389
## 3     Germany   2.189425     0.7848618 3.218514
## 4 Switzerland   3.456124     1.2282151 3.448661
## 5     Finland   3.217284     1.3926494 3.340424</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Points size reflecting Cook&#39;s distance</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> results, <span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .resid, <span class="dt">size =</span> .cooksd)) +
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;firebrick3&quot;</span>) +
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> .<span class="dv">5</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">rownames</span>(results))) +
<span class="st">  </span><span class="kw">scale_size_area</span>(<span class="st">&quot;Cook’s distance&quot;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Mit dem <code>sjPlot</code> package geht alles viel einfacher.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(sjPlot)
<span class="kw">sjp.lm</span>(fit2, <span class="dt">type =</span> <span class="st">&quot;ma&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 3
##     models adjusted.r2      aic
##      &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;
## 1 original   0.6434510 432.8847
## 2  updated   0.6804059 410.5064</code></pre>
<p><img src="linear_model_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /><img src="linear_model_files/figure-html/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;" /><img src="linear_model_files/figure-html/unnamed-chunk-6-3.png" width="672" style="display: block; margin: auto;" /><img src="linear_model_files/figure-html/unnamed-chunk-6-4.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelgute.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["linear_model.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
